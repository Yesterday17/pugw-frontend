---
title: 用户信息
lang: zh-CN
---

# 用户信息

::: warning 实现进度
- `pug-backend`：100%
- `pugw-frontend`：0%
:::

`pug-backend` 提供简单的用户信息管理功能。

所有用户信息管理功能需要在凭据有效的情况下进行。

## 用户类型

用户有如下类型：

- 普通用户
- 管理员用户

默认情况下二者的差别仅在于：管理员用户可以任意修改普通用户的相关内容。但管理员用户还可以给普通用户增加限制。

## 用户信息

已登录用户可以访问并修改自身属性，下面介绍对应的接口。

### GET /user

获取用户信息，成功时返回如下格式的 `JSON`：

```json
{
  "uuid": "string",
  "name": "昵称",
  "icon": "头像链接"
}
```

返回状态如下：
- `200`：成功获取用户信息。
- `500`：数据库读失败。

### GET /user/setting

获取用户全局设置，成功时返回如下格式：

```json
{
  "category1": {
    "key": "value"
  },
  "category2": {
    "key": "value"
  }
}
```

#### 请求参数

| 参数名   | 类型   | 必须 | 描述                                            | 默认值 |
| -------- | ------ | ---- | ----------------------------------------------- | ------ |
| category | string | 否   | 获取某一分类的设置                              | -      |
| key      | string | 否   | 获取某一分类下的某一设置，需要先设置 `category` | -      |

返回状态如下：
- `200`：成功获取用户设置。
- `404`：`category` 或 `key` 不存在。
- `500`：数据库读失败。

### PATCH /user/setting

修改用户全局设置，接收 `multipart/form-data`。有如下字段：

- `category`：配置的分类
- `data`：配置的内容，是通过 `JSON.parse` 处理后的字符串，格式和上文获取的用户配置一致。

有如下返回状态：

- `200`：成功配置用户设置。
- `400`：输入非法，包括 `category` 不存在或非空，`data` 不存在或非空，`data` 的 `JSON` 字符串解析失败，或无有效字段更新。
- `404`：`category` 不存在。
- `500`：数据库读失败或数据库写失败。

